import{t as x,a as f}from"../chunks/BI9x2Sv-.js";import{p as Vt,b as u,w as Bt,a8 as Rt,f as ut,a as zt,t as F,g as t,u as U,d as l,$ as At,c as r,r as s,s as i}from"../chunks/C7yO5yPs.js";import{d as qt,h as Ht,s as g}from"../chunks/C2vv__MR.js";import{i as P}from"../chunks/BGOvWai6.js";import{e as Kt,i as Qt}from"../chunks/CSQrPbMc.js";import{s as Wt,r as Xt}from"../chunks/DIyWOdGJ.js";import{r as Yt}from"../chunks/jPbBvQ6a.js";import{b as ct}from"../chunks/ZONVNPKG.js";import{o as Zt}from"../chunks/BREDD7G0.js";import{F as $t}from"../chunks/B1PP8j1y.js";import{l as R}from"../chunks/C2QKWiPL.js";import{p as te}from"../chunks/Cr0urJXs.js";import{l as _t,L as ee}from"../chunks/BVqQsvwE.js";import{P as ae}from"../chunks/g4djdWft.js";import{b as re}from"../chunks/6usKf036.js";import{P as se}from"../chunks/TtOy7PfW.js";function ft(M,O,p,o){l(O,null),l(p,!1),l(o,!0)}async function le(M,O,p,o,b,E,N,D){if(!t(O)||!t(p)||!t(o).trim()){l(b,"Title cannot be empty.");return}l(E,!0),l(b,null);try{await R.updateGoal(t(p),t(o).trim(),t(N).trim()),l(D,!1)}catch(w){l(b,w instanceof Error?w.message:"Failed to save changes",!0),console.error("Save failed:",w)}finally{l(E,!1)}}function ie(M,O,p,o,b,E){l(O,!1),l(p,null),t(o)&&(l(b,t(o).title,!0),l(E,t(o).description,!0))}var oe=x('<div class="loading svelte-1mxmn70">Loading goal data...</div>'),ne=x('<div class="error svelte-1mxmn70"><h2>Error</h2> <p> </p> <a>Back to Goals</a></div>'),ve=x('<p class="edit-error svelte-1mxmn70"> </p>'),me=x('<div><input type="text" class="title-input svelte-1mxmn70" placeholder="Goal Title"> <textarea class="desc-textarea svelte-1mxmn70" placeholder="Goal Description"></textarea> <div class="edit-actions svelte-1mxmn70"><button class="btn btn-success btn-sm svelte-1mxmn70"> </button> <button class="btn btn-secondary btn-sm svelte-1mxmn70">Cancel</button></div> <!></div>'),de=(M,O,p)=>{l(O,!0),l(p,null)},pe=x('<div class="page-header svelte-1mxmn70"><h1> </h1> <p class="description svelte-1mxmn70"> </p> <button class="btn btn-outline-secondary btn-sm edit-button svelte-1mxmn70">Edit</button></div>'),ue=x('<div class="empty-state svelte-1mxmn70"><p>No prompts found for this goal.</p> <button class="btn btn-primary">Create First Prompt</button></div>'),ce=x('<div class="prompt-card-wrapper svelte-1mxmn70"><!></div>'),_e=x('<div class="card-container"><button class="card new-item-card"><div>+</div> <div>Create New Prompt</div></button> <!></div>'),fe=x('<div class="loading svelte-1mxmn70">Loading logs...</div>'),ge=x('<div class="no-items svelte-1mxmn70">No logs found for this goal</div>'),xe=x('<div class="edit-container svelte-1mxmn70"><!></div> <div class="spend-data"> </div> <div class="meta-info svelte-1mxmn70"><div class="meta-item"><strong>Goal ID:</strong> </div> <div class="meta-item"><strong>Prompts:</strong> </div></div> <h2>Example</h2> <div class="examples svelte-1mxmn70"><details class="example-panel"><summary><div class="item-title">Input Variables</div> <pre class="svelte-1mxmn70"> </pre></summary> <pre class="svelte-1mxmn70"> </pre></details> <details class="example-panel"><summary><div class="item-title">Output Variables</div> <pre class="svelte-1mxmn70"> </pre></summary> <pre class="svelte-1mxmn70"> </pre></details></div> <h2>Prompts</h2> <!> <div class="item-title">Recent Logs</div> <!> <details class="goal-debug svelte-1mxmn70"><summary class="svelte-1mxmn70">Debug Info</summary> <!></details>',1),be=x('<div class="goal-page svelte-1mxmn70"><!></div> <!>',1);function je(M,O){Vt(O,!0);let p=U(()=>te.params.goaluid),o=U(()=>{var n,c;return(c=(n=R)==null?void 0:n.goals)==null?void 0:c[t(p)]}),b=U(()=>{var n,c;return((c=(n=R)==null?void 0:n.promptsByGoalUID)==null?void 0:c[t(p)])||null}),E=u(!0),N=u(null),D=u(Bt([])),w=u(null),z=u(!1),V=u(!1),A=u(null),at=u(!1),j=u(!1),G=u(""),T=u(""),I=u(!1),J=u(null);Rt(()=>{t(o)&&!t(j)&&(l(G,t(o).title,!0),l(T,t(o).description,!0))}),Zt(async()=>{l(E,!0);try{await R.initialize(),l(z,!0);const n=await _t.getGoalLogs(t(p),{includeRaw:!0,limit:5,offset:0});l(D,n==null?void 0:n.logs,!0),l(w,await _t.getSpend({goalUID:t(p)}),!0)}catch(n){l(N,n instanceof Error?n.message:"Failed to load data",!0)}finally{l(E,!1),l(z,!1)}});var rt=be();Ht(n=>{F(()=>{var c;return At.title=`${((c=t(o))==null?void 0:c.title)||"Goal Details"} - LLMango`})});var q=ut(rt),gt=r(q);{var xt=n=>{var c=oe();f(n,c)},bt=(n,c)=>{{var Ot=S=>{var C=ne(),L=i(r(C),2),H=r(L,!0);s(L);var K=i(L,2);Wt(K,"href",`${re??""}/goal`),s(C),F(()=>g(H,t(N))),f(S,C)},kt=S=>{var C=xe(),L=ut(C),H=r(L);{var K=e=>{var a=me(),m=r(a);Xt(m);var _=i(m,2);Yt(_);var v=i(_,2),d=r(v);d.__click=[le,o,p,G,J,I,T,j];var h=r(d,!0);s(d);var y=i(d,2);y.__click=[ie,j,J,o,G,T],s(v);var B=i(v,2);{var Jt=k=>{var et=ve(),Ut=r(et);s(et),F(()=>g(Ut,`Error: ${t(J)??""}`)),f(k,et)};P(B,k=>{t(J)&&k(Jt)})}s(a),F(k=>{m.disabled=t(I),_.disabled=t(I),d.disabled=k,g(h,t(I)?"Saving...":"Save"),y.disabled=t(I)},[()=>t(I)||!t(G).trim()]),ct(m,()=>t(G),k=>l(G,k)),ct(_,()=>t(T),k=>l(T,k)),f(e,a)},Et=e=>{var a=pe(),m=r(a),_=r(m,!0);s(m);var v=i(m,2),d=r(v,!0);s(v);var h=i(v,2);h.__click=[de,j,J],s(a),F(()=>{var y,B;g(_,(y=t(o))==null?void 0:y.title),g(d,(B=t(o))==null?void 0:B.description)}),f(e,a)};P(H,e=>{t(j)?e(K):e(Et,!1)})}s(L);var Q=i(L,2),Pt=r(Q);s(Q);var W=i(Q,2),X=r(W),wt=i(r(X));s(X);var st=i(X,2),Lt=i(r(st));s(st),s(W);var Y=i(W,4),Z=r(Y),$=r(Z),lt=i(r($),2),Dt=r(lt,!0);s(lt),s($);var it=i($,2),Gt=r(it,!0);s(it),s(Z);var ot=i(Z,2),tt=r(ot),nt=i(r(tt),2),It=r(nt,!0);s(nt),s(tt);var vt=i(tt,2),St=r(vt,!0);s(vt),s(ot),s(Y);var mt=i(Y,4);{var Ct=e=>{var a=ue(),m=i(r(a),2);m.__click=[ft,A,at,V],s(a),f(e,a)},Ft=e=>{var a=_e(),m=r(a);m.__click=[ft,A,at,V];var _=i(m,2);Kt(_,17,()=>t(b),Qt,(v,d)=>{var h=ce(),y=r(h);se(y,{get prompt(){return t(d)},editable:!0}),s(h),f(v,h)}),s(a),f(e,a)};P(mt,e=>{!t(b)||t(b).length===0?e(Ct):e(Ft,!1)})}var dt=i(mt,4);{var Mt=e=>{var a=fe();f(e,a)},Nt=(e,a)=>{{var m=v=>{const d=U(()=>t(D)||[]);ee(v,{get logs(){return t(d)}})},_=v=>{var d=ge();f(v,d)};P(e,v=>{t(D)&&t(D).length>0?v(m):v(_,!1)},a)}};P(dt,e=>{t(z)?e(Mt):e(Nt,!1)})}var pt=i(dt,2),jt=i(r(pt),2);const Tt=U(()=>JSON.stringify(t(o)));$t(jt,{get jsonText(){return t(Tt)}}),s(pt),F((e,a,m,_,v)=>{var d,h,y;g(Pt,`Total Spend: $${e??""} (${((d=t(w))==null?void 0:d.count)??""} runs)`),g(wt,` ${((h=t(o))==null?void 0:h.UID)??""}`),g(Lt,` ${((y=t(b))==null?void 0:y.length)??""}`),g(Dt,a),g(Gt,m),g(It,_),g(St,v)},[()=>{var e,a;return(a=(e=t(w))==null?void 0:e.spend)==null?void 0:a.toFixed(3)},()=>{var e,a;return Object.keys(((a=(e=t(o))==null?void 0:e.inputOutput)==null?void 0:a.inputExample)||{}).join(", ")},()=>{var e,a;return JSON.stringify((a=(e=t(o))==null?void 0:e.inputOutput)==null?void 0:a.inputExample,null,2)},()=>{var e,a;return Object.keys(((a=(e=t(o))==null?void 0:e.inputOutput)==null?void 0:a.outputExample)||{}).join(", ")},()=>{var e,a;return JSON.stringify((a=(e=t(o))==null?void 0:e.inputOutput)==null?void 0:a.outputExample,null,2)}]),f(S,C)};P(n,S=>{t(N)?S(Ot):S(kt,!1)},c)}};P(gt,n=>{t(E)?n(xt):n(bt,!1)})}s(q);var ht=i(q,2);{var yt=n=>{ae(n,{get isOpen(){return t(V)},get goalUID(){return t(p)},get prompt(){return t(A)},onClose:()=>l(V,!1)})};P(ht,n=>{t(o)&&n(yt)})}f(M,rt),zt()}qt(["click"]);export{je as component};
