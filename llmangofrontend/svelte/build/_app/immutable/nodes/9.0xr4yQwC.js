import{t as v,a as l,c as Et}from"../chunks/BI9x2Sv-.js";import{p as At,b as P,w as Ft,a as Jt,s as a,c as s,d as c,g as t,u as g,r as o,t as Y,f as D}from"../chunks/C7yO5yPs.js";import{d as jt,s as T}from"../chunks/C2vv__MR.js";import{i as h}from"../chunks/BGOvWai6.js";import{e as St,i as Rt}from"../chunks/CSQrPbMc.js";import{M as Wt,P as zt,a as Gt,s as Bt}from"../chunks/g4djdWft.js";import{o as Ht}from"../chunks/BREDD7G0.js";import{F}from"../chunks/B1PP8j1y.js";import{l as J}from"../chunks/C2QKWiPL.js";import{p as Kt}from"../chunks/Cr0urJXs.js";import{b as ct}from"../chunks/6usKf036.js";import{C as Qt}from"../chunks/CExfrwZq.js";import{l as Vt,L as Xt}from"../chunks/BVqQsvwE.js";import{g as Yt}from"../chunks/D8IDVr_6.js";function Zt(I,_){c(_,!0)}function $t(I,_,b){c(_,!1),c(b,!0)}async function te(I,_,b){if(confirm("⚠️ Are you sure you want to delete this prompt? This action cannot be undone and may affect existing solutions."))try{await J.deletePrompt(t(_)),Yt(ct+"/prompt")}catch(r){c(b,r instanceof Error?r.message:"Failed to delete prompt",!0)}}var ee=v('<div class="loading svelte-o1fqdw">Loading prompt data...</div>'),ae=v('<div class="error svelte-o1fqdw"> </div>'),se=v('<div><div class="message-header svelte-o1fqdw"><span class="message-role svelte-o1fqdw"> </span> <span class="message-index"></span></div> <div class="message-content svelte-o1fqdw"><!></div></div>'),oe=v('<div class="no-messages svelte-o1fqdw">No messages defined for this prompt</div>'),re=v('<h3>Parameters</h3> <div class="parameters-container svelte-o1fqdw"><!></div>',1),ie=v("<!> <!>",1),ne=v('<div class="loading-goal svelte-o1fqdw">Loading goal information...</div>'),le=v("<h3>Associated Goal</h3> <!>",1),ve=v('<div class="no-goal svelte-o1fqdw"><span class="muted-text svelte-o1fqdw">No goal attached to this prompt</span></div>'),de=v('<div class="loading-small svelte-o1fqdw">Loading logs...</div>'),ce=v('<div class="no-logs svelte-o1fqdw">No logs found for this prompt</div>'),pe=(I,_)=>c(_,!1),fe=v('<div class="warning-section svelte-o1fqdw"><h4>⚠️ Data Consistency Risk</h4> <p>Editing this prompt may affect existing solutions and goals that use it. This action cannot be undone.</p> <p>Are you sure you want to proceed?</p></div> <div class="modal-actions svelte-o1fqdw"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary">⚠️ Proceed</button></div>',1),me=v('<div class="prompt-header svelte-o1fqdw"><h2> </h2></div> <div class="card prompt-card svelte-o1fqdw"><h3>Details</h3> <div class="metadata-container svelte-o1fqdw"><div class="metadata-section svelte-o1fqdw"><h4 class="svelte-o1fqdw">Prompt ID</h4> <div class="item-attribute svelte-o1fqdw"> </div></div> <div class="metadata-section svelte-o1fqdw"><h4 class="svelte-o1fqdw">Model</h4> <div class="item-attribute svelte-o1fqdw"> </div></div></div> <h3>Messages</h3> <div class="messages-container svelte-o1fqdw"><!></div> <!> <!> <h3>Recent Logs</h3> <!> <details class="unsafe-actions svelte-o1fqdw"><summary class="svelte-o1fqdw">⚠️ Unsafe Actions</summary> <div class="unsafe-actions-content svelte-o1fqdw"><p class="warning-text">These actions may affect data consistency and cannot be undone. Use with caution.</p> <div class="unsafe-buttons"><button class="btn btn-warning">⚠️ Edit Prompt</button> <button class="btn btn-danger">⚠️ Delete Prompt</button></div></div></details> <details class="prompt-debug svelte-o1fqdw"><summary class="svelte-o1fqdw">Debug Info</summary> <!></details></div> <!> <!>',1),ue=v("<div>No prompt  but loaded</div>"),ge=v('<div class="prompt-page svelte-o1fqdw"><div>Prompt page</div> <!></div>');function Ne(I,_){At(_,!0);let b=g(()=>Kt.params.promptuid),r=g(()=>J.prompts[t(b)]||null),q=g(()=>{var p;return J.goals[(p=t(r))==null?void 0:p.goalUID]||null}),k=P(null),j=P(!0),C=P(Ft([])),S=P(!1),U=P(!1),R=P(!1);Ht(async()=>{var p;c(j,!0);try{await J.initialize(),(p=t(r))==null||p.goalUID,c(S,!0);const m=await Vt.getPromptLogs(t(b),{includeRaw:!0,limit:5,offset:0});c(C,(m==null?void 0:m.logs)||[],!0)}catch(m){c(k,m instanceof Error?m.message:"Failed to load data",!0)}finally{c(j,!1),c(S,!1)}});var W=ge(),pt=a(s(W),2);{var ft=p=>{var m=ee();l(p,m)},mt=(p,m)=>{{var ut=x=>{var O=ae(),z=s(O,!0);o(O),Y(()=>T(z,t(k))),l(x,O)},gt=(x,O)=>{{var z=y=>{var E=me(),G=D(E),Z=s(G),ht=s(Z,!0);o(Z),o(G);var B=a(G,2),H=a(s(B),2),K=s(H),$=a(s(K),2),wt=s($,!0);o($),o(K);var tt=a(K,2),et=a(s(tt),2),bt=s(et,!0);o(et),o(tt),o(H);var Q=a(H,4),qt=s(Q);{var xt=e=>{var i=Et(),f=D(i);St(f,17,()=>t(r).messages,Rt,(u,n,d)=>{var w=se(),L=s(w),M=s(L),dt=s(M,!0);o(M);var A=a(M,2);A.textContent=`#${d+1}`,o(L);var N=a(L,2),X=s(N);Gt(X,{get message(){return t(n).content},get goal(){return t(q)}}),o(N),o(w),Y(()=>{Bt(w,1,`message ${t(n).role??""}`,"svelte-o1fqdw"),T(dt,t(n).role)}),l(u,w)}),l(e,i)},yt=e=>{var i=oe();l(e,i)};h(qt,e=>{t(r).messages&&t(r).messages.length>0?e(xt):e(yt,!1)})}o(Q);var at=a(Q,2);{var Pt=e=>{var i=re(),f=a(D(i),2),u=s(f);const n=g(()=>JSON.stringify(t(r).parameters));F(u,{get jsonText(){return t(n)}}),o(f),l(e,i)};h(at,e=>{t(r).parameters&&e(Pt)})}var st=a(at,2);{var Dt=e=>{var i=le(),f=a(D(i),2);{var u=d=>{const w=g(()=>t(q).description||"No description"),L=g(()=>`${ct}/goal/${t(q).UID}`);Qt(d,{get title(){return t(q).UID},get description(){return t(w)},get href(){return t(L)},children:(M,dt)=>{var A=ie(),N=D(A);const X=g(()=>JSON.stringify(t(q).inputOutput.inputExample||""));F(N,{get jsonText(){return t(X)}});var kt=a(N,2);const Ct=g(()=>JSON.stringify(t(q).inputOutput.outputExample||""));F(kt,{get jsonText(){return t(Ct)}}),l(M,A)},$$slots:{default:!0}})},n=d=>{var w=ne();l(d,w)};h(f,d=>{t(q)?d(u):d(n,!1)})}l(e,i)},It=e=>{var i=ve();l(e,i)};h(st,e=>{t(r).goalUID?e(Dt):e(It,!1)})}var ot=a(st,4);{var Ut=e=>{var i=de();l(e,i)},Ot=(e,i)=>{{var f=n=>{const d=g(()=>t(C)||[]);Xt(n,{get logs(){return t(d)}})},u=n=>{var d=ce();l(n,d)};h(e,n=>{t(C)&&t(C).length>0?n(f):n(u,!1)},i)}};h(ot,e=>{t(S)?e(Ut):e(Ot,!1)})}var V=a(ot,2),rt=a(s(V),2),it=a(s(rt),2),nt=s(it);nt.__click=[Zt,U];var Lt=a(nt,2);Lt.__click=[te,b,k],o(it),o(rt),o(V);var lt=a(V,2),Mt=a(s(lt),2);const Nt=g(()=>JSON.stringify(t(r)));F(Mt,{get jsonText(){return t(Nt)}}),o(lt),o(B);var vt=a(B,2);Wt(vt,{get isOpen(){return t(U)},title:"Warning",onClose:()=>c(U,!1),children:(e,i)=>{var f=fe(),u=a(D(f),2),n=s(u);n.__click=[pe,U];var d=a(n,2);d.__click=[$t,U,R],o(u),l(e,f)},$$slots:{default:!0}});var Tt=a(vt,2);zt(Tt,{get goalUID(){return t(r).goalUID},get prompt(){return t(r)},get isOpen(){return t(R)},onClose:()=>c(R,!1)}),Y(()=>{T(ht,t(r).UID||"Untitled Prompt"),T(wt,t(r).UID),T(bt,t(r).model||"Default")}),l(y,E)},_t=y=>{var E=ue();l(y,E)};h(x,y=>{t(r)?y(z):y(_t,!1)},O)}};h(p,x=>{t(k)?x(ut):x(gt,!1)},m)}};h(pt,p=>{t(j)?p(ft):p(mt,!1)})}o(W),l(I,W),Jt()}jt(["click"]);export{Ne as component};
