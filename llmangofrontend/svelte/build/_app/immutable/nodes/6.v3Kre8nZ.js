import{t as g,a as c}from"../chunks/BI9x2Sv-.js";import{p as H,t as L,a as J,s as o,c as d,o as Z,r as u,b as F,w as A,a8 as ee,d as _,g as e,f as q,u as te}from"../chunks/C7yO5yPs.js";import{s as I,d as ae}from"../chunks/C2vv__MR.js";import{i as O}from"../chunks/BGOvWai6.js";import{e as C,i as E}from"../chunks/CSQrPbMc.js";import{L as oe,l as le,t as ie,f as re}from"../chunks/BVqQsvwE.js";import{o as se}from"../chunks/BREDD7G0.js";import{l as G}from"../chunks/C2QKWiPL.js";import{s as ne}from"../chunks/nC63Ge9I.js";import{s as ve}from"../chunks/DIyWOdGJ.js";import{b as de}from"../chunks/DfDD2GHB.js";import{p as ue}from"../chunks/0fouXmC9.js";var pe=g('<div class="floating-label svelte-wyz93q"> </div>'),_e=g('<div class="filter-select-wrapper svelte-wyz93q"><!> <select class="svelte-wyz93q"><!></select></div>');function M(j,l){H(l,!0);let s=ue(l,"value",15);var f=_e(),x=d(f);{var i=z=>{var h=pe(),w=d(h,!0);u(h),L(()=>I(w,l.label)),c(z,h)};O(x,z=>{s()!==void 0&&s()!==null&&s()!==""&&z(i)})}var a=o(x,2),R=d(a);ne(R,()=>l.children??Z),u(a),u(f),L(()=>ve(a,"id",l.id)),de(a,s),c(j,f),J()}function ce(j,l,s){e(l).offset=(e(s).page-2)*e(l).limit}function ge(j,l,s){e(l).offset=e(s).page*e(l).limit}function fe(j,l,s){_(l,{includeRaw:!0,limit:5,offset:0},!0),e(s).page=5}var me=g("<option> </option>"),be=g("<option>All Goals</option> <!>",1),Pe=g("<option> </option>"),ke=g("<option>All Prompts</option> <!>",1),ze=g("<option>5</option> <option>10</option> <option>20</option> <option>50</option>",1),he=g('<div class="pagination svelte-cjzdk6"><button class="svelte-cjzdk6">Previous</button> <span> </span> <button class="svelte-cjzdk6">Next</button></div>'),je=g('<div class="loading svelte-cjzdk6">Loading logs...</div>'),xe=g('<div class="logs-page"><div class="page-header"><h1 class="svelte-cjzdk6">Logs</h1></div> <div class="filters-section svelte-cjzdk6"><div class="item-title">Filter Logs</div> <div class="filter-controls svelte-cjzdk6"><div class="filter-selects svelte-cjzdk6"><!> <!> <!></div> <button class="btn btn-secondary svelte-cjzdk6">Reset Filters</button></div></div> <!> <!> <!></div>');function Me(j,l){H(l,!0);let s=F(A([])),f=F(!1),x=F(!1),i=F(A({page:1,totalPages:1,total:0,perPage:10})),a=F(A({includeRaw:!0,limit:10,offset:0}));ee(()=>{e(x)!==!1&&R()});async function R(){_(f,!0);try{const t=await le.getAllLogs(e(a));t.pagination.totalPages!=0&&e(a).offset/e(a).limit>t.pagination.totalPages&&(e(a).offset=(t.pagination.totalPages-1)*e(a).limit),_(s,t.logs,!0),_(i,t.pagination,!0)}catch(t){console.error("Failed to load logs:",t),_(s,[],!0)}finally{_(f,!1)}}se(async()=>{_(f,!0),_(x,!1);try{G.initialize(),_(x,!0)}catch(t){console.error("Failed to initialize:",t)}finally{_(f,!1)}});var z=xe(),h=o(d(z),2),w=o(d(h),2),D=d(w),T=d(D);M(T,{id:"goalFilter",label:"Goal",get value(){return e(a).goalUID},set value(t){e(a).goalUID=t},children:(t,m)=>{var n=be(),r=q(n);r.value=(r.__value=void 0)==null?"":void 0;var b=o(r,2);C(b,17,()=>Object.entries(G.goals),E,(p,k)=>{let P=()=>e(k)[0],U=()=>e(k)[1];var v=me(),y={},$=d(v,!0);u(v),L(()=>{y!==(y=P())&&(v.value=(v.__value=P())==null?"":P()),I($,U().title||P())}),c(p,v)}),c(t,n)},$$slots:{default:!0}});var N=o(T,2);M(N,{id:"promptFilter",label:"Prompt",get value(){return e(a).promptUID},set value(t){e(a).promptUID=t},children:(t,m)=>{var n=ke(),r=q(n);r.value=(r.__value=void 0)==null?"":void 0;var b=o(r,2);C(b,17,()=>Object.entries(G.prompts),E,(p,k)=>{let P=()=>e(k)[0],U=()=>e(k)[1];var v=Pe(),y={},$=d(v,!0);u(v),L(()=>{y!==(y=P())&&(v.value=(v.__value=P())==null?"":P()),I($,U().UID||P())}),c(p,v)}),c(t,n)},$$slots:{default:!0}});var K=o(N,2);M(K,{id:"paginationResponse.perPageFilter",label:"Per Page",get value(){return e(a).limit},set value(t){e(a).limit=t},children:(t,m)=>{var n=ze(),r=q(n);r.value=(r.__value=5)==null?"":5;var b=o(r,2);b.value=(b.__value=10)==null?"":10;var p=o(b,2);p.value=(p.__value=20)==null?"":20;var k=o(p,2);k.value=(k.__value=50)==null?"":50,c(t,n)},$$slots:{default:!0}}),u(D);var Q=o(D,2);Q.__click=[fe,a,i],u(w),u(h);var S=o(h,2);const V=te(()=>e(s)||[]);oe(S,{get logs(){return e(V)},get cells(){return e(i).perPage}});var B=o(S,2);{var W=t=>{var m=he(),n=d(m);n.__click=[ce,a,i];var r=o(n,2),b=d(r);u(r);var p=o(r,2);p.__click=[ge,a,i],u(m),L(()=>{n.disabled=e(i).page<=1,I(b,`Page ${e(i).page??""} of ${e(i).totalPages??""} (Total: ${e(i).total??""} logs)`),p.disabled=e(i).page>=e(i).totalPages}),c(t,m)};O(B,t=>{(e(i).totalPages>1||e(i).total>0)&&t(W)})}var X=o(B,2);{var Y=t=>{var m=je();ie(1,m,()=>re,()=>({duration:300})),c(t,m)};O(X,t=>{e(f)&&t(Y)})}u(z),c(j,z),J()}ae(["click"]);export{Me as component};
